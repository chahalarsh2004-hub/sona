<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Valentine Surprise</title>

  <!-- Romantic fonts (kept available, but heading will use the standard font) -->
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1: #fff0f6;
      --bg2: #ffe6f0;
      --accent: #ff2466;
      --accent-2: #ff6b9a;
      --muted: #5a3b3b;
      --card: rgba(255,255,255,0.9);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: 'Poppins', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: radial-gradient(1200px 600px at 10% 10%, #fff6fb 0%, var(--bg1) 25%, var(--bg2) 60%);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      overflow:hidden;
      color:var(--muted);
    }

    /* floating hearts background */
    .floating-hearts{
      position:fixed;
      inset:0;
      pointer-events:none;
      z-index:0;
      overflow:hidden;
    }
    .floating-hearts i{
      position:absolute;
      width:18px;
      height:18px;
      transform:translateY(0) rotate(0);
      opacity:0.85;
      background:linear-gradient(180deg, #ff7aa6, #ff3568);
      -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M12 21s-7.5-4.9-9.3-8.2C-.4 7.6 5.3 3 8.4 5.4 10 6.8 12 9 12 9s2-2.2 3.6-3.6C18.7 3 24.4 7.6 21.3 12.8 19.5 16.1 12 21 12 21z"/></svg>') center/contain no-repeat;
      mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="white" d="M12 21s-7.5-4.9-9.3-8.2C-.4 7.6 5.3 3 8.4 5.4 10 6.8 12 9 12 9s2-2.2 3.6-3.6C18.7 3 24.4 7.6 21.3 12.8 19.5 16.1 12 21 12 21z"/></svg>') center/contain no-repeat;
      filter: drop-shadow(0 4px 12px rgba(255,82,120,0.08));
      will-change: transform, opacity;
    }

    @keyframes floatUp {
      0% { transform: translateY(0) translateX(0) rotate(0deg); opacity:0; }
      10% { opacity:1; }
      100% { transform: translateY(-120vh) translateX(var(--tx, 0px)) rotate(var(--rot, 0deg)); opacity:0; }
    }

    /* central card */
    .page {
      width:100%;
      max-width:820px;
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:64vh;
      z-index:1;
      position:relative;
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.95), rgba(255,245,249,0.95));
      border-radius:20px;
      padding:44px;
      box-shadow: 0 14px 40px rgba(203,54,98,0.12);
      text-align:center;
      width:100%;
      transition: transform .6s cubic-bezier(.2,.9,.3,1), opacity .4s ease;
      transform-origin:center;
      backdrop-filter: blur(6px) saturate(1.05);
      position:relative;
    }

    .intro-hero{ display:flex; flex-direction:column; align-items:center; gap:18px; }

    /* Title: both lines use the standard (Poppins/system) font now */
    .hero-title{
      color:var(--accent);
      font-size:56px;
      margin:0;
      line-height:1;
      letter-spacing:1px;
      text-shadow: 0 6px 14px rgba(255,91,128,0.08);
      transform: translateY(10px) scale(0.98);
      opacity:0;
      animation: entrance 900ms cubic-bezier(.2,.9,.3,1) forwards 200ms;
      display:inline-block;
    }
    .hero-title .standard,
    .hero-title .fancy {
      /* both use the standard Poppins/system font */
      font-family: 'Poppins', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      font-weight:700;
      display:block;
      color:var(--muted);
      text-transform:none; /* keep natural casing */
    }
    /* keep second line accent color */
    .hero-title .fancy {
      color:var(--accent);
      margin-top:6px;
    }

    @keyframes entrance { to { transform: translateY(0) scale(1); opacity:1; } }

    .sub{ font-size:15px; color:#6b4a57; margin:0; opacity:0; transform: translateY(10px); animation: entrance 800ms forwards 380ms; }

    .btn{
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      color:white;
      border:0;
      padding:14px 28px;
      border-radius:999px;
      font-weight:700;
      cursor:pointer;
      font-size:16px;
      box-shadow: 0 8px 30px rgba(255,59,107,0.16);
      transition:transform .18s ease, box-shadow .18s ease;
      outline: none;
    }
    .btn:active{transform:translateY(2px)}
    .btn.heartbeat{ animation: heartbeat 1.6s ease-in-out infinite; }
    @keyframes heartbeat{
      0%{ transform:scale(1); } 14%{ transform:scale(1.06); } 28%{ transform:scale(1); } 42%{ transform:scale(1.04); } 70%{ transform:scale(1); } 100%{ transform:scale(1); }
    }

    /* quiz */
    .quiz-card{ max-width:560px; margin:0 auto; }
    .question{ font-size:26px; margin:0 0 8px 0; color:#3f3f3f; letter-spacing:.4px; transform: translateY(10px); opacity:0; animation: entrance 700ms forwards 160ms; }

    .options{ display:grid; gap:12px; margin-top:18px; transform: translateY(10px); opacity:0; animation: entrance 700ms forwards 260ms; }
    .option{
      background:linear-gradient(180deg,#fff,#fff8fb);
      border:2px solid rgba(255,59,107,0.06);
      padding:14px 16px;
      border-radius:12px;
      cursor:pointer;
      font-size:16px;
      font-weight:600;
      color:#3a3a3a;
      transition:all .16s cubic-bezier(.2,.9,.3,1);
      text-align:left;
      display:flex;
      align-items:center;
      gap:12px;
      justify-content:flex-start;
      box-shadow: 0 6px 18px rgba(255,91,128,0.04);
    }
    .option:hover{ transform: translateY(-6px) rotate(-1deg) scale(1.01); box-shadow: 0 18px 40px rgba(255,91,128,0.08); }
    .option:focus{ outline:3px solid rgba(255,107,140,0.12) }

    .result{
      margin-top:20px;
      padding:18px;
      border-radius:14px;
      background:linear-gradient(90deg,#fff7f9,#fff2f6);
      color:#a01a49;
      font-weight:700;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.6);
      transform-origin:center;
      transform: scale(.98);
      opacity:0;
      transition: transform .3s ease, opacity .28s ease;
    }
    .result.show{ transform: scale(1); opacity:1; animation: pop 420ms cubic-bezier(.2,.9,.3,1); }
    @keyframes pop { from { transform: scale(.92); opacity:0; } to { transform: scale(1); opacity:1; } }

    .small-note{ font-size:13px; color:#7a585f; margin-top:8px; }
    .controls{ display:flex; gap:12px; justify-content:center; margin-top:18px }
    .btn.ghost{
      background:transparent;
      color:var(--accent);
      border:2px solid rgba(255,59,107,0.08);
      padding:10px 20px;
      border-radius:999px;
      font-weight:700;
      box-shadow:none;
    }

    /* decorative hearts on card */
    .card::before{
      content:'';
      position:absolute;
      width:160px;
      height:160px;
      right:-40px;
      top:-40px;
      background: radial-gradient(circle at 30% 30%, rgba(255,82,120,0.14), transparent 15%),
                  radial-gradient(circle at 70% 70%, rgba(255,107,140,0.12), transparent 18%);
      border-radius:50%;
      transform: rotate(20deg);
      pointer-events:none;
    }

    /* modal */
    .modal-backdrop{
      position:fixed;
      inset:0;
      background: rgba(10,6,12,0.45);
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:9000;
      padding:20px;
    }
    .modal-card{
      background: linear-gradient(180deg,#fff,#fff7fb);
      border-radius:14px;
      padding:22px;
      max-width:420px;
      width:100%;
      box-shadow:0 18px 50px rgba(0,0,0,0.25);
      text-align:center;
      color:#5b2d3a;
      position:relative;
    }
    .modal-close{
      position:absolute;
      right:10px;
      top:8px;
      border:0;
      background:transparent;
      font-size:20px;
      line-height:1;
      color:#7a434f;
      cursor:pointer;
    }
    .modal-title{ font-weight:800; letter-spacing:1px; margin:8px 0; color:var(--accent); }
    .modal-desc{ margin:8px 0 16px 0; color:#6e444b; }

    /* responsive */
    @media (max-width:640px){ .hero-title{font-size:36px} .card{padding:22px} .option{font-size:15px} }

    /* prefers-reduced-motion */
    @media (prefers-reduced-motion: reduce) {
      .btn.heartbeat { animation: none; }
      .floating-hearts i { animation: none !important; opacity: 0.9; transform: translateY(-30vh); }
      .card, .option, .hero-title, .sub { transition: none; animation: none; }
    }

    /* hidden utility */
    .hidden{ display:none; }
  </style>
</head>
<body>
  <div class="floating-hearts" id="floating" aria-hidden="true"></div>

  <main class="page" aria-live="polite">
    <section class="card intro" id="introCard" role="region" aria-label="Intro">
      <div class="intro-hero">
        <h1 class="hero-title">
          <span class="standard">GO AHEAD AT YOUR OWN RISK,</span>
          <span class="fancy">THERE'S NO COMING BACK...</span>
        </h1>
        <p class="sub">If your heart's ready, take that little leap...</p>
        <button id="startBtn" class="btn heartbeat" aria-controls="quizCard" aria-expanded="false">LET'S GOOO...</button>
      </div>
    </section>

    <section class="card hidden quiz-card" id="quizCard" role="region" aria-label="Valentine Question" aria-hidden="true">
      <h2 class="question">WILL YOU BE MY VALENTINE</h2>

      <div class="options" role="list" id="optionsList" aria-label="Answers">
        <button class="option" role="listitem" tabindex="0">1. YESS</button>
        <button class="option" role="listitem" tabindex="0">2. DYING TO BE</button>
        <button class="option" role="listitem" tabindex="0">3. NO OTHER OPTION</button>
        <button class="option" role="listitem" tabindex="0">4. I WILL BE YOUR WIFE.</button>
      </div>

      <div id="result" class="result" role="status" aria-live="polite" aria-atomic="true"></div>

      <div class="controls">
        <button id="restart" class="btn ghost hidden" aria-hidden="true">Try Again</button>
      </div>

      <p class="small-note">Tip: Click any option and see the surprise. Use arrow keys to navigate and Enter to select. Press Esc to go back.</p>
    </section>
  </main>

  <!-- modal: repeated confirmation -->
  <div id="confirmModal" class="modal-backdrop hidden" role="dialog" aria-modal="true" aria-labelledby="confirmTitle" aria-hidden="true">
    <div class="modal-card" role="document">
      <button class="modal-close" id="modalClose" aria-label="Close dialog">&times;</button>
      <h3 id="confirmTitle" class="modal-title">ARE YOU SURE?</h3>
      <p class="modal-desc">THINK AGAIN BEFORE COMMENCING</p>
      <div style="display:flex; gap:12px; justify-content:center; margin-top:10px;">
        <button id="modalProceed" class="btn">Proceed</button>
        <button id="modalCancel" class="btn ghost">Close</button>
      </div>
      <p style="font-size:12px; color:#8a5a63; margin-top:12px">(This will pop a few times — just to be dramatic.)</p>
    </div>
  </div>

  <script>
    // Result messages for each option (index 0..3)
    const ANSWER_MESSAGES = [
      "OKAYY", // for option 1 (YESS)
      "DON'T DIE", // for option 2 (DYING TO BE)
      "NEVER THINK OF ONE...", // for option 3 (NO OTHER OPTION)
      "RIGHT ANSWER, REMEMBER, YOU ARE LUCKY AND THE MOST BEAUTIFUL WOMEN IN THIS ENTIRE WORLD, I LOVE YOU SONAL." // for option 4
    ];

    // small utility debounce
    function debounce(fn, wait=120){
      let t;
      return (...args) => {
        clearTimeout(t);
        t = setTimeout(() => fn(...args), wait);
      };
    }

    document.addEventListener('DOMContentLoaded', () => {
      const intro = document.getElementById('introCard');
      const quiz = document.getElementById('quizCard');
      const startBtn = document.getElementById('startBtn');
      const options = Array.from(document.querySelectorAll('.option'));
      const resultEl = document.getElementById('result');
      const restart = document.getElementById('restart');
      const floating = document.getElementById('floating');

      const modal = document.getElementById('confirmModal');
      const modalClose = document.getElementById('modalClose');
      const modalCancel = document.getElementById('modalCancel');
      const modalProceed = document.getElementById('modalProceed');

      // Number of times modal will reappear (3 or 4)
      const modalAttempts = 3 + Math.floor(Math.random()*2); // 3 or 4
      let modalCloseCount = 0;
      let modalActive = false;
      let modalTimer = null;

      // create floating hearts
      function spawnBackgroundHearts(count = 14) {
        const effectiveCount = Math.max(6, Math.round(count * Math.min(1, window.innerWidth / 900)));
        floating.innerHTML = '';
        for (let i = 0; i < effectiveCount; i++) {
          const el = document.createElement('i');
          const size = 10 + Math.random() * 36;
          el.style.width = size + 'px';
          el.style.height = size + 'px';
          el.style.left = (Math.random() * 110) + '%';
          el.style.top = (40 + Math.random() * 60) + '%';
          el.style.opacity = (0.5 + Math.random() * 0.6).toFixed(2);
          el.style.setProperty('--tx', ( -60 + Math.random() * 120 ) + 'px');
          el.style.setProperty('--rot', ( -720 + Math.random() * 720 ) + 'deg');
          const dur = 12 + Math.random() * 16;
          if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
            el.style.transform = `translateY(-30vh) translateX(${el.style.getPropertyValue('--tx')}) rotate(${el.style.getPropertyValue('--rot')})`;
            el.style.opacity = 0.95;
          } else {
            el.style.animation = `floatUp ${dur}s linear ${-Math.random()*6}s infinite`;
          }
          floating.appendChild(el);
        }
      }
      spawnBackgroundHearts(18);

      // Modal helpers
      function showModal() {
        modal.classList.remove('hidden');
        modal.setAttribute('aria-hidden','false');
        modalActive = true;
        // trap focus minimally: focus first action
        modalProceed.focus();
      }
      function hideModal() {
        modal.classList.add('hidden');
        modal.setAttribute('aria-hidden','true');
        modalActive = false;
      }

      // Start modal sequence
      function startModalSequence() {
        modalCloseCount = 0;
        showModal();
      }

      modalClose.addEventListener('click', () => {
        hideModal();
        modalCloseCount++;
        if (modalCloseCount < modalAttempts) {
          modalTimer = setTimeout(() => { showModal(); }, 600);
        } else {
          proceedToQuiz();
        }
      });

      modalCancel.addEventListener('click', () => { modalClose.click(); });

      modalProceed.addEventListener('click', () => {
        if (modalTimer) { clearTimeout(modalTimer); modalTimer = null; }
        hideModal();
        proceedToQuiz();
      });

      // transition to quiz view
      function proceedToQuiz() {
        intro.style.transform = 'scale(.96) translateY(-6px)';
        intro.style.opacity = '0';
        startBtn.classList.remove('heartbeat');
        startBtn.setAttribute('aria-expanded', 'true');
        setTimeout(() => {
          intro.classList.add('hidden');
          quiz.classList.remove('hidden');
          quiz.setAttribute('aria-hidden', 'false');
          quiz.style.transform = 'translateY(6px) scale(.98)';
          quiz.style.opacity = '0';
          setTimeout(() => {
            quiz.style.transform = '';
            quiz.style.opacity = '';
            options[0].focus();
          }, 50);
        }, 380);
      }

      // Start button triggers modal sequence
      startBtn.addEventListener('click', () => {
        startBtn.classList.remove('heartbeat');
        startModalSequence();
      });

      // --- Canvas / confetti/hearts system ---
      let canvas, ctx, particles = [], running = false;
      const prefersReduced = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

      function makeCanvas() {
        if (canvas) return;
        canvas = document.createElement('canvas');
        canvas.style.position = 'fixed';
        canvas.style.left = 0;
        canvas.style.top = 0;
        canvas.style.width = '100%';
        canvas.style.height = '100%';
        canvas.style.pointerEvents = 'none';
        canvas.style.zIndex = 9999;
        document.body.appendChild(canvas);
        const dpr = Math.min(window.devicePixelRatio || 1, 2);
        canvas.width = Math.round(window.innerWidth * dpr);
        canvas.height = Math.round(window.innerHeight * dpr);
        canvas._dpr = dpr;
        ctx = canvas.getContext('2d');
        ctx.scale(dpr, dpr);

        window.addEventListener('resize', debounce(() => {
          if (!canvas) return;
          const dpr2 = Math.min(window.devicePixelRatio || 1, 2);
          canvas.width = Math.round(window.innerWidth * dpr2);
          canvas.height = Math.round(window.innerHeight * dpr2);
          canvas._dpr = dpr2;
          ctx = canvas.getContext('2d');
          ctx.scale(dpr2, dpr2);
        }, 120));
      }

      function createParticles(x, y, count = 18, colors = null, spread = 120) {
        if (prefersReduced) return;
        makeCanvas();
        const colorsDefault = ['#ff4f7a','#ff7aa6','#ffd1e0','#ff3568','#ff6b9a'];
        const used = colors || colorsDefault;
        for (let i = 0; i < count; i++) {
          const angle = (Math.random() * Math.PI * 2);
          const speed = 1.4 + Math.random() * 5.4;
          const vx = Math.cos(angle) * speed;
          const vy = Math.sin(angle) * speed * -1.2 - Math.random()*1.6;
          const size = 8 + Math.random() * 28;
          const life = 60 + Math.round(Math.random()*60);
          const color = used[Math.floor(Math.random()*used.length)];
          const rot = Math.random()*Math.PI*2;
          const angular = (Math.random() - 0.5) * 0.2;
          particles.push({ x, y, vx, vy, size, life, color, rot, angular, opacity:1 });
        }
        if (!running) {
          running = true;
          requestAnimationFrame(loop);
        }
      }

      function drawHeart(cx, cy, size, color, rotation, opacity) {
        ctx.save();
        ctx.translate(cx, cy);
        ctx.rotate(rotation);
        ctx.globalAlpha = opacity;
        ctx.fillStyle = color;
        // draw simple heart using path
        const s = size / 20;
        ctx.beginPath();
        ctx.moveTo(0, -10 * s);
        ctx.bezierCurveTo(12 * s, -30 * s, 40 * s, -6 * s, 0, 20 * s);
        ctx.bezierCurveTo(-40 * s, -6 * s, -12 * s, -30 * s, 0, -10 * s);
        ctx.closePath();
        ctx.fill();
        ctx.restore();
        ctx.globalAlpha = 1;
      }

      function loop() {
        if (!canvas) { running = false; return; }
        ctx.clearRect(0, 0, canvas.width / canvas._dpr, canvas.height / canvas._dpr);
        for (let i = particles.length - 1; i >= 0; i--) {
          const p = particles[i];
          p.x += p.vx;
          p.y += p.vy;
          p.vy += 0.06; // gravity
          p.vx *= 0.995;
          p.rot += p.angular;
          p.life--;
          p.opacity = Math.max(0, p.life / 100);
          drawHeart(p.x, p.y, p.size, p.color, p.rot, p.opacity);
          if (p.life <= 0 || p.y > window.innerHeight + 100) {
            particles.splice(i, 1);
          }
        }
        if (particles.length > 0) {
          requestAnimationFrame(loop);
        } else {
          running = false;
          // cleanup canvas element after small delay
          setTimeout(() => {
            if (!running && canvas) {
              canvas.remove();
              canvas = null;
              ctx = null;
            }
          }, 700);
        }
      }

      // public trigger confetti
      function triggerConfetti(originX = window.innerWidth / 2, originY = window.innerHeight / 3, intensity = 22, wide = 240) {
        if (prefersReduced) return;
        createParticles(originX, originY, intensity, null, wide);
      }

      // --- Option selection logic ---
      function showResultFor(index) {
        // show message
        resultEl.textContent = ANSWER_MESSAGES[index] || '';
        resultEl.classList.add('show');
        restart.classList.remove('hidden');
        restart.removeAttribute('aria-hidden');

        // animate—bigger for index 3 (the intended correct answer)
        const rect = options[index].getBoundingClientRect();
        const cx = rect.left + rect.width / 2;
        const cy = rect.top + rect.height / 2;

        if (index === 3) {
          // big celebration
          for (let i = 0; i < 3; i++) {
            setTimeout(() => triggerConfetti(cx, cy - 60, 26 + Math.round(Math.random()*18)), i*120);
          }
        } else {
          // small particle burst
          triggerConfetti(cx, cy - 20, 10 + Math.round(Math.random()*8));
        }

        // aria
        resultEl.setAttribute('aria-hidden', 'false');
      }

      // clicking an option
      options.forEach((opt, i) => {
        opt.addEventListener('click', (ev) => {
          ev.preventDefault();
          // show repeating dramatic modal sequence before final selection? Not needed at this point
          showResultFor(i);
        });
      });

      // keyboard navigation and selection
      const optionsList = document.getElementById('optionsList');
      optionsList.addEventListener('keydown', (e) => {
        const active = document.activeElement;
        const idx = options.indexOf(active);
        if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
          e.preventDefault();
          const next = options[(idx + 1) % options.length];
          next.focus();
        } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
          e.preventDefault();
          const prev = options[(idx - 1 + options.length) % options.length];
          prev.focus();
        } else if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          if (idx >= 0) options[idx].click();
        } else if (e.key === 'Escape') {
          e.preventDefault();
          // go back to intro
          goBackToIntro();
        }
      });

      // restart flow
      restart.addEventListener('click', () => {
        // reset
        resultEl.classList.remove('show');
        resultEl.textContent = '';
        restart.classList.add('hidden');
        restart.setAttribute('aria-hidden','true');
        options[0].focus();
      });

      // Esc to go back to intro - used by page-level keydown too
      function goBackToIntro() {
        if (intro.classList.contains('hidden')) {
          // show intro
          quiz.classList.add('hidden');
          quiz.setAttribute('aria-hidden','true');
          intro.classList.remove('hidden');
          intro.style.transform = '';
          intro.style.opacity = '';
          startBtn.classList.add('heartbeat');
          startBtn.setAttribute('aria-expanded','false');
          startBtn.focus();
          // reset quiz UI state
          resultEl.classList.remove('show');
          resultEl.textContent = '';
          restart.classList.add('hidden');
          restart.setAttribute('aria-hidden','true');
        }
      }

      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          // if modal is visible, close modal
          if (!modal.classList.contains('hidden')) {
            modalClose.click();
            return;
          }
          // else go back to intro from quiz
          if (!quiz.classList.contains('hidden')) {
            goBackToIntro();
          }
        }
      });

      // basic accessibility: allow clicking outside modal to close
      modal.addEventListener('click', (ev) => {
        if (ev.target === modal) modalClose.click();
      });

      // focus handling for options on mouse hover/click to keep keyboard-friendly
      options.forEach(o => {
        o.addEventListener('mouseover', () => o.focus());
      });

      // ensure restart hidden initially
      restart.classList.add('hidden');
      restart.setAttribute('aria-hidden','true');

      // initial focus trap: pressing Enter on start button also works
      startBtn.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          startBtn.click();
        }
      });
    });
  </script>
</body>
</html>
